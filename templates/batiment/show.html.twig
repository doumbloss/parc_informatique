{% extends 'base.html.twig' %}

{% block title %}Détails du Bâtiment{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
{% endblock %}

{% block body %}
<div class="container mt-5">
    <h1 class="mb-4 text-success text-center">Détails du Bâtiment</h1>

    <div class="card mb-4">
        <div class="card-body">
            <h5 class="card-title">Nom : {{ batiment.nom }}</h5>
            <p class="card-text">Description : {{ batiment.description }}</p>
        </div>
    </div>

    <h3 class="text-primary mb-3">Carte des Localisations</h3>
    <div id="map" style="height: 400px;"></div>

    <script>
        const map = L.map('map').setView([9.5092, -13.7122], 13); // Vue par défaut Conakry

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);

        {% for localisation in batiment.localisations %}
            {% if localisation.latitude is not null and localisation.longitude is not null %}
                L.marker([{{ localisation.latitude }}, {{ localisation.longitude }}])
                    .addTo(map)
                    .bindPopup("<strong>{{ localisation.nomBatiment }}</strong><br>{{ localisation.salle }}");
            {% endif %}
        {% endfor %}
    </script>

    <div class="mt-3">
        <a href="{{ path('app_batiment_index') }}" class="btn btn-secondary">Retour à la liste</a>
    </div>
</div>
{% endblock %}
